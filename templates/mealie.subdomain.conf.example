## Version 2025/07/18
# Ensure your DNS has a CNAME set for mealie and that mealie container is named.

server {
    listen 443 ssl;
#    listen 443 quic;
    listen [::]:443 ssl;
#    listen [::]:443 quic;

    server_name example.com;

    include /config/nginx/ssl.conf;

    client_max_body_size 0;

    # Security headers
    # From: https://itsfoss.gitlab.io/post/how-to-configure-security-headers-in-nginx/

    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;
    add_header X-Frame-Options "DENY" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header Referrer-Policy "no-referrer-when-downgrade" always;
    add_header Content-Security-Policy "default-src 'self' http: https: data: blob: 'unsafe-inline'" always;

    # Authentication (template)
    # enable for additional authentication, e.g. oAuth

    location / {
        include /config/nginx/proxy.conf;
        #include /config/nginx/resolver.conf;
        resolver 127.0.0.11 valid=30s; # use Dockers internal DNS resolver
        set $upstream_app mealie;
        set $upstream_port 9000;
        set $upstream_proto http;
        proxy_pass $upstream_proto://$upstream_app:$upstream_port;

    }
}

